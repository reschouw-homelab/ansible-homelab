# Primary Bind9 Configuration file

# Load options
include "/etc/bind/named.conf.options";

{% if primary %}
# Load dhcpupdate key file
include "/etc/bind/dhcpupdate.key";
{% endif %}

#
# Zone Configurations
#

{% if primary %}
# Static entries for servers and infrastructure
zone "dorwinia.com" {
	type master;
	file "/var/lib/bind/db.dorwinia.com";
	allow-transfer { 192.168.1.12; };
        };

# Dynamic zone for home LAN
zone "local.dorwinia.com" {
	type master;
	file "/var/lib/bind/db.local.dorwinia.com";
	allow-transfer { 192.168.1.12; };
	allow-update { key "dhcpupdate"; };
        };

# Dynamic zone for guest LAN
zone "guest.dorwinia.com" {
	type master;
	file "/var/lib/bind/db.guest.dorwinia.com";
	allow-transfer { 192.168.1.12; };
	allow-update { key "dhcpupdate"; };
        };

# Reverse entries for MGMT LAN
zone "1.168.192.in-addr.arpa" {
	type master;
	file "/var/lib/bind/db.192";
	allow-transfer { 192.168.1.12; };
	allow-update { key "dhcpupdate"; };
	};

# Reverse entries for home LAN
zone ".40.0.10.in-addr.arpa" {
	type master;
	file "/var/lib/bind/db.10.0.40";
	allow-transfer { 192.168.1.12; };
	allow-update { key "dhcpupdate"; };
	};

# Reverse entries for guest LAN
zone "50.0.10.in-addr.arpa" {
	type master;
	file "var/lib/bind/db.10.0.50";
	allow-transfer { 192.168.1.12; };
	allow-update { key "dhcpupdate" };
	};

{% else %}
# Static entries for servers and infrastructure
zone "dorwinia.com" {
        type slave;
	notify no;
        file "/var/cache/bind/db.dorwinia.com";
        masters { 192.168.1.11; };
        };

# Dynamic entries for home LAN
zone "local.dorwinia.com" {
        type slave;
	notify no;
        file "/var/cache/bind/db.local.dorwinia.com";
        masters { 192.168.1.11; };
        };

# Dynamic entries for guest LAN
zone "guest.dorwinia.com" {
        type slave;
	notify no;
        file "/var/cache/bind/db.guest.dorwinia.com";
        masters { 192.168.1.11; };
        };

# Reverse entries for MGMT LAN
zone "1.168.192.in-addr.arpa" {
        type slave;
	notify no;
        file "/var/cache/bind/db.192";
        masters { 192.168.1.11; };
	};

# Reverse entries for home LAN
zone "40.0.10.in-addr.arpa" {
	type slave;
	notify no;
	file "/var/cache/bind/db.10.0.40";
	masters { 192.168.1.11; };
	};

# Reverse entries for guest LAN
zone "50.0.10.in-addr.arpa" {
	type slave;
	notify no;
	file "/var/cache/bind/db.10.0.50";
	masters { 192.168.1.11; };
	};

{% endif %}
